<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title> express crud </title>
    <link rel="stylesheet" href="/js/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/js/vendor/mu/mu.min.css">
</head>
<body>

<div class="container">
    <div class="row">
        <div class="col-md-4">

                <h3>新增专题</h3>

                <div class="form-group">
                    <label for="alias">别名</label>
                    <input type="text" class="form-control" placeholder="别名" name="alias" id="el-alias">
                    <!-- <div class="alert alert-info" role="alert">用来生成路径,格式只能为字母.(一旦确认将不能修改）</div> -->
                </div>
                <div class="form-group">
                    <select name="langs" id="el-langs">
                        <option value="all">all</option>
                        <option value="en">en</option>
                        <option value="jp">jp</option>
                        <option value="kr">kr</option>
                        <option value="fr">fr</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="title">标题</label>
                    <input type="text" class="form-control" placeholder="标题" name="title" id="el-title">
                </div>
                <div class="form-group">
                    <label for="description">描述</label>
                    <input type="text" class="form-control" placeholder="描述" name="description" id="el-description">
                </div>

                <div class="form-group">
                    <label for="shareImage">分享图片</label>
                    <input type="text" class="form-control" placeholder="分享图片" name="shareImage" id="el-shareImage">
                </div>
                <div class="form-group">
                    <label for="shareTitle">分享标题</label>
                    <input type="text" class="form-control" placeholder="分享标题" name="shareTitle" id="el-shareTitle">
                </div>
                <div class="form-group">
                    <label for="shareDesc">分享描述</label>
                    <input type="text" class="form-control" placeholder="分享描述" name="shareDesc" id="el-shareDesc">
                </div>

                <a href="javascript:;" class="btn btn-primary post-page"> 提交 </a>
                <a href="/" class="btn btn-link">cancel</a>
        </div>
    </div>
</div>

<script src="/js/vendor/jquery/jquery-1.9.1.min.js"></script>
<script src="/js/api.js"></script>
<script>
    (function() {
        'use strict';

        var alias = document.getElementById('el-alias'),
            langs = document.getElementById('el-langs'),
            title = document.getElementById('el-title'),
            description = document.getElementById('el-description'),
            shareImage = document.getElementById('el-shareImage'),
            shareTitle = document.getElementById('el-shareTitle'),
            shareDesc = document.getElementById('el-shareDesc');
        var isPost = false;
        $('.post-page').on('click', function(){
            if(isPost) {
                alert('Posting...');
                return;
            }
            isPost = true;
            var data = {
                alias: alias.value,
                langs: langs.value,
                title: title.value,
                description: description.value,

                shareImage: shareImage.value,
                shareTitle: shareTitle.value,
                shareDesc: shareDesc.value,
            };

            data.content = '{}';

            $.ajax({
                url: '/api/add',
                type: 'POST',
                data: {
                    data: JSON.stringify(data)
                },
                success: function(data){
                    console.log(data);
                    if(data.Code === 0){
                        location.href = '/';
                    }else{
                        alert('please fill the form');
                    }
                },
                complete: function(){
                    isPost = false;
                }
            })
        });

    }());

</script>
<script>

</script>

</body>
</html>
